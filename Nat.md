# מהו NAT?  

![image](https://github.com/user-attachments/assets/11287bd0-cca7-45de-83da-6c2929b548f9)


שירות ה-NAT מתרגם כתובות IP פרטיות ברשת פנימית לכתובת IP חיצונית לפני שליחת פקטות לרשת חיצונית. שירות זה מהווה את הפתרון הנפוץ ביותר למצוקת הכתובות. NAT מיושם לעתים קרובות בראוטר הקצה של ה-WAN שהוגדר לכך על מנת לאפשר גישה לאינטרנט.

כדי לגשת לאינטרנט יש צורך בכתובת IP ציבורית אחת, אך אנו יכולים להשתמש בכתובת IP פנימית ברשת הפנימית שלנו. הרעיון של NAT הוא לאפשר למספר מכשירים לגשת לאינטרנט דרך כתובת חיצונית אחת. תרגום כתובות רשת (NAT) הוא תהליך שבו כתובת IP פנימית אחת או יותר מתורגמת לכתובת IP חיצונית אחת או יותר ולהיפך על מנת לספק גישה לאינטרנט למארחים המקומיים.

בנוסף NAT מבצע את התרגום של מספר הפורט, כלומר מסווה את מספר הפרט של המקור עם מספר פורט יציאה אחר, בחבילה שתנותב ליעד. לאחר מכן הוא מבצע את התאמה של כתובת IP ומספר פורט ומכניס את המידע לטבלת NAT.

### איך תרגום כתובות רשת (NAT) עובד?

בדרך כלל, ראטור מוגדר עבור NAT כלומר הראוטר שיש לו ממשק אחד ברשת הפנימית וממשק אחד ברשת החיצונית. כאשר פקטה עוברת מחוץ לרשת המקומית, אז NAT ממיר כתובת IP פנימית לכתובת IP חיצונית. כאשר חבילה נכנסת לרשת המקומית, כתובת ה-IP החיצונית מומרת לכתובת IP פנימית.

![image](https://github.com/user-attachments/assets/8b5e58b4-c9ad-4524-b152-10c2b8fb39a9)

## ישנם שלושה סוגי NAT

![image](https://github.com/user-attachments/assets/420aa924-7154-4b38-890d-c60bddc52c9d)


### סוג ראשון - static NAT

סוג NAT זה מאפשר תרגום סטטי של כתובות, לכתובת פנימית רצויה תהיה כתובת חיצונית אחת איתה תצא לרשת.

### סוג שני - dynamic NAT

סוג NAT זה מתרגם טווח של כתובות פנימיות, מול טווח(pool) של כתובות חיצוניות. הטווח של הכתובות החיצוניות יוגדר על ידינו זאת בשביל שהראוטר יוכל לחלק אותם.

### סוג שלישי - PAT- NAT overload

נקרא גם - PAT port address translation.

סוג זה מתרגם מספר כתובות פנימיות לכתובת חיצונית אחת או מספר מועט של כתובות באמצעות שימוש בפורטים לוגיים שונים.

### סוג וחצי - NAT משולב

יתכן מצב שבו נצטרך להשתמש בשילוב של שניים או יותר סוגים של NAT.

![image](https://github.com/user-attachments/assets/a9d17cca-a293-4dd1-8277-b2a8c5311efd)

## התמודדות עם NAT כתוקף:

תרגום כתובות רשת (NAT) יכול להציב אתגרים עבור תוקפים בכמה דרכים:

תחילה NAT מסתיר את כתובות ה-IP הפנימיות של התקנים מאחורי כתובת IP ציבורית אחת. זה מקשה על התוקפים למקד ישירות למכשירים ספציפיים בתוך הרשת הפרטית מכיוון שהם לא יכולים לקבוע בקלות את כתובות ה-IP הפנימיות.

בנוסף התוקפים מסתמכים על סריקת רשת כדי לאסוף מידע על מטרות פוטנציאליות. NAT מסבך תהליך זה על ידי סיבוך מבנה הרשת הפנימית וכתובות ה-IP. התוקפים עשויים להזדקק לטכניקות סריקה נוספות או להנדסה חברתית כדי לאסוף פרטי רשת פנימיים.

כדי להתמודד ביעילות עם NAT כתוקף, ניתן לנקוט במספר גישות:

ניצול יציאות ידועות - תוקפים מכוונים לעתים קרובות לשירותים הפועלים בפורטים ידועות (למשל, HTTP בפורט 80, SSH בפורט 22). יציאות אלו עשויות להיחשף באמצעות NAT באמצעות העברת יציאות או תצורות DMZ. מציאת יציאות פתוחות וניצול נקודות תורפה בשירותים הפועלים ביציאות אלו עדיין יכולים להיות יעילים.

2. **הנדסה חברתית**: אם התקפות טכניות ישירות מופרעות על ידי NAT, התוקפים עשויים לפנות לטכניקות של הנדסה חברתית כדי להערים על משתמשים לחשוף מידע או לבצע פעולות הפוגעות באבטחה. לדוגמה, התקפות דיוג או הונאות טלפון עשויות לשמש כדי לקבל פרטי רשת פנימיים.

3. **טכניקות חציית NAT**: תוקפים מתקדמים עשויים להשתמש בטכניקות חציית NAT כדי לעקוף מגבלות NAT. טכניקות אלו כוללות ניצול פגיעויות ביישומי NAT ​​או שימוש בפרוטוקולים כמו UPnP (Universal Plug and Play) כדי לפתוח יציאות באופן דינמי.

4. **מיקוד להתקפות צד לקוח**: במקום לתקוף את הרשת ישירות, התוקפים עשויים להתמקד בניצול נקודות תורפה בתוכנות צד לקוח (למשל, דפדפני אינטרנט, לקוחות דוא"ל) כדי לקבל גישה למכשירים בתוך הרשת כאשר משתמשים גולשים אתרים זדוניים או פתוחים קבצים מצורפים לדואר אלקטרוני נגועים.

5. **איומים פנימיים**: אם תוקף משיג גישה למכשיר בתוך הרשת (למשל, באמצעות הדבקה בתוכנה זדונית), הוא יכול להשתמש במכשיר שנפרץ כבסיס להפעלת התקפות נוספות נגד מכשירים אחרים באותה רשת, תוך עקיפת הגבלות NAT באופן פנימי.

לסיכום, בעוד NAT מספקת שכבת אבטחה על ידי ערפול פרטי רשת פנימיים, תוקפים נחושים עדיין יכולים למצוא דרכים לנצל פגיעויות וטכניקות הנדסה חברתית כדי לסכן מערכות מאחורי NAT. הגנה מפני התקפות כאלה דורשת גישה רב-שכבתית הכוללת תצורה מאובטחת, עדכונים שוטפים והדרכה למודעות משתמש.
