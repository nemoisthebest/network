# מהי מערכת IPS?

מערכת אקטיבית למניעת חדירה IPS(Intrusion Prevention System) יכולה לזהות או למנוע התקפות אבטחת רשת כגון התקפות brute force, התקפות מניעת שירות (DoS) וניצול פגיעות(vulnerability exploits). פגיעות(vulnerability) היא חולשה במערכת וניצולה הוא התקפה שממנפת את הפגיעות הזו כדי להשיג שליטה על המערכת. כאשר עולים על חולשה, לתוקפים יש חלון הזדמנויות מוגבל לנצל את הפגיעות הזו לפני החלת תיקון האבטחה. ניתן להשתמש במערכת IPS במקרים אלה כדי לחסום במהירות התקפות אלו.

מכיוון שטכנולוגיות IPS עוקבות אחר זרימות פקטות, ניתן להשתמש בהן גם כדי לאכוף את השימוש בפרוטוקולים מאובטחים ולשלול את השימוש בפרוטוקולים לא מאובטחים כגון גרסאות קודמות של SSL או פרוטוקולים המשתמשים בצפנים חלשים.

כיצד פועלת מערכת זו?
<br>
לטכנולוגיות IPS יש גישה לפקטות היכן שהן נמצאות, בין אם כמערכות זיהוי חדירות ברשת (NIDS), או כמערכות זיהוי חדירות מארח (HIDS). לרשת IPS יש תצוגה גדולה יותר של הרשת כולה וניתן לפרוס אותו ברשת או במצב לא מקוון לרשת כחיישן פסיבי המקבל פקטות מפורט TAP או SPAN ברשת.

ה-IPS משתמש בשיטות הזיהוי העיקריות שהן; מבוססת חתימה או מבוססת אנומליה. חתימות מוגדרות מראש הן דפוסים של התקפות רשת ידועות. ה-IPS משווה זרימות פקטות עם החתימה כדי לראות אם יש התאמה של דפוס. מערכות זיהוי חדירות מבוססות אנומליות משתמשות בהיוריסטיקה(heuristics) כדי לזהות איומים, למשל השוואת מדגם של תעבורה מול קו-בסיס(baseline) ידוע.

![image](https://github.com/user-attachments/assets/8f5c0c1c-79f3-4475-89a4-0973c879fc0c)


# מהי מערכת IDS?

מערכת פסיבית לזיהוי חדירה IDS(Intrusion Detection System) היא כלי אבטחת רשת המנטר את תעבורת הרשת והתקנים עבור פעילות זדונית ידועה, פעילות חשודה או הפרות של מדיניות אבטחה. IDS יכול לעזור להאיץ ולהפוך את זיהוי איומי הרשת לאוטומטי על ידי התראה למנהלי אבטחה על איומים ידועים או פוטנציאליים, או על ידי שליחת התראות לכלי אבטחה מרכזי. כלי אבטחה מרכזי כגון מערכת מידע אבטחה וניהול אירועים (SIEM) יכול לשלב נתונים ממקורות אחרים כדי לעזור לצוותי אבטחה לזהות ולהגיב לאיומי סייבר שעלולים להחליק באמצעי אבטחה אחרים. 

מערכת IDS לא יכולה לעצור את איומי האבטחה בעצמה. כיום יכולות IDS משולבות בדרך כלל עם, או משולבות במערכות למניעת חדירות (IPS), שיכולות לזהות איומי אבטחה ולפעול אוטומטית למניעתם.
להגיש תלונה

כיצד פועלת מערכת זו?
<br>
מערכות ה-IDS יכולים להיות אפליקציות המותקנות על נקודות קצה או על התקני חומרה ייעודיים המחוברים לרשת. חלק מפתרונות IDS זמינים כשירותי ענן. לא משנה באיזה צורה הוא יישום, גם ה-IDS משתמש באחת משתי שיטות זיהוי האיומים העיקריות או בשתיהן: זיהוי מבוסס חתימה או מבוסס אנומליה. זיהוי מבוסס חתימה, מנתח פקטות רשת עבור חתימות תקיפה עם מאפיינים או התנהגויות ייחודיות הקשורות לאיום ספציפי. רצף של קוד המופיע בגרסה מסוימת של תוכנות זדוניות הוא דוגמה לחתימת התקפה. IDS מבוסס חתימה מחזיק מסד נתונים של חתימות תקיפה מולו שאותו הוא משווה בין פקטות ברשת. אם פקטה נמצאה מתאימה לאחת החתימות, ה-IDS מסמן אותה. זיהוי המבוסס על אנומליות, שיטות זיהוי המבוססות על אנומליות משתמשות בלמידת הרשת כדי ליצור מודל בסיסי של פעילות רשת רגילה. לאחר מכן הוא משווה את פעילות הרשת לדגם ומסמן סטיות - כמו תהליך שמשתמש ברוחב פס גדול מהרגיל, או מכשיר שפותח פורט.


![image](https://github.com/user-attachments/assets/b1ec745c-5d72-4738-9a46-7864757b811d)


# מהי suricata?

סוריקטה היא מערכת מבוססת קוד פתוח לזיהוי חדירות (IDS), מערכת למניעת חדירות (IPS) ומנוע ניטור אבטחת רשת בעלת ביצועים גבוהים. הוא משמש ארגונים בכל רחבי העולם כדי לזהות איומי סייבר ולנטר רשתות לאיתור פעילות חשודה. כלי זה יכול להתמודד עם כמויות גדולות של תעבורת רשת ולייצר כמויות אדירות של נתוני תעבורת רשת, בנוסף הוא מציע ניתוח מעמיק של פרוטוקולים שונים ויכולת להתאים אישית את מערכות הכללים כך שיתאימו לצרכים הספציפיים של הארגון שלך. מכיוון שמדובר ב-IDS/IPS בקוד פתוח, Suricata זוכה בקהילה גדולה ופעילה שמפתחת ומשכללת כל הזמן את היכולות שלה.

סוריקטה פועלת על ידי ניתוח תעבורת רשת ובדיקתה מול מסד נתונים של כללים או חתימות קיימים. כאשר התעבורה תואמת חתימה, מונפקת התראה המאותתת למשתמש ליזום פעולת תגובה. רשימות חוקים של Suricata יכולות להיות מותאמות אישית או מיובאות ממקורות צד שלישי. Suricata הוא כלי רב עוצמה וניתן להתאמה המספק שכבת הגנה חזקה עבור אסטרטגיית אבטחת הרשת של כל ארגון.

כלל ב-Suricata הוא בעצם הוראה המגדירה איזה סוג של תעבורת רשת לחפש ואיזו פעולה לנקוט אם היא תימצא. זה כמו תוכנית עבור Suricata לזהות איומים פוטנציאליים.

הוא פותח על ידי OISF וקהילת Suricata ונמצא בבעלות של הקרן לאבטחת מידע פתוחה (OISF).


![image](https://github.com/user-attachments/assets/4c691166-538b-464d-b722-b0843390fe75)


דוגמה לסינטקס בחוק ב-Suricata
<br>
אם נבצע חוק ב-Suricata, נשתמש בסינטקס שכולל את המרכיבים הבאים:
<br>
פעולה (alert, log, drop וכו')
<br>
פרוטוקול (tcp, udp, http וכו')
<br>
כתובת מקור ויעד
<br>
פורטים
<br>
אופציות נוספות (כגון חיפושים בתוכן, בדיקות מבוססות רגולרי וכו')

לדוגמה, חוק פשוט ב-Suricata:
<br>
alert tcp any any -> 192.168.1.1 80 (msg:"Example alert"; sid:1000001;)

הסינטקס של החוק הזה כולל את כל המרכיבים הנדרשים והאופציות הנוספות בצורה מסודרת, כך ש-Suricata תוכל להבין אותו ולבצע את הבדיקות הנדרשות על תנועת הרשת.

תיאור הפרמטרים:
<p dir="rtl" style="text-align: right;">
  action:
<br>
alert – להתריע על תנועה שעומדת בתנאים.
<br>
log – לנהל רישום של התנועה.
<br>
drop – לחסום את התנועה.
<br>
reject – לחסום את התנועה ולשלוח הודעה למקור.
<br>
pass – להתעלם מהתנועה.
<br>
</p>
<p dir="rtl" style="text-align: right;">
  protocol:
<br>
הפרוטוקול של התנועה (כגון tcp, udp, icmp, http, וכו').
</p>
<p dir="rtl" style="text-align: right;">
  source_ip:
<br>
כתובת ה-IP של השולח (יכול להיות כתובת ספציפית, טווח כתובות, או any לכל כתובת).
</p>
<p dir="rtl" style="text-align: right;">
  source_port:
<br>
מספר הפורט של השולח (יכול להיות מספר ספציפי, טווח פורטים, או any לכל פורט).
</p>
<p dir="rtl" style="text-align: right;">
  destination_ip:
<br>
כתובת ה-IP של היעד (כמו עם כתובת השולח).
</p>
<p dir="rtl" style="text-align: right;">
  destination_port:
<br>
מספר הפורט של היעד (כמו עם פורט השולח).

</p> 
<p dir="rtl" style="text-align: right;">
  options:
<br>
פרמטרים נוספים שמבצעים בדיקות מסוימות כמו חיפושים בתוכן, פרמטרים של אורך, פרמטרים של תיקון וכו'.
</p>  
